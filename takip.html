<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sipariş Takip | Upsilon Dev</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="takip.css"> </head>
    <link rel="icon" type="image/png" href="logo.png">
<body>
    <div class="bg-glow"></div>

    <header class="header">
        <div class="logo"><span class="studio-name">Upsilon Dev</span></div>
        <nav class="nav"><a href="index.html">Ana Sayfa</a></nav>
    </header>

    <section class="tracking-section">
        <div class="container">
            
            <div class="search-box">
                <h1 class="glitch-text" data-text="SİPARİŞ TAKİP SİSTEMİ">SİPARİŞ TAKİP SİSTEMİ</h1>
                <p>Sipariş kodunuzu girerek proje durumunu canlı izleyin.</p>
                
                <div class="input-wrapper">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="orderInput" placeholder="Örn: UPS-2025-X">
                    <button onclick="startTracking()" class="track-btn">SORGULA</button>
                </div>
            </div>

            <div id="loadingUI" class="loading-ui" style="display: none;">
                <div class="terminal-loader">
                    <div class="terminal-header">
                        <span class="dot red"></span>
                        <span class="dot yellow"></span>
                        <span class="dot green"></span>
                    </div>
                    <div class="terminal-text" id="terminalLog">
                        > Veritabanına bağlanılıyor...<br>
                    </div>
                </div>
                <div class="progress-bar"><div class="progress-fill"></div></div>
            </div>

            <div id="resultHUD" class="result-hud" style="display: none;">
                <div class="hud-header">
                    <div class="project-title">
                        <span class="label">PROJE:</span>
                        <h2 id="projName">DISTOPIK ŞEHİR MAP</h2>
                    </div>
                    <div class="status-badge processing" id="mainStatus">YAPIM AŞAMASINDA</div>
                </div>

                <div class="tracker-steps">
                    <div class="step completed">
                        <div class="step-icon"><i class="fas fa-file-contract"></i></div>
                        <span>Sipariş Alındı</span>
                    </div>
                    <div class="step completed">
                        <div class="step-icon"><i class="fas fa-pencil-ruler"></i></div>
                        <span>Planlama</span>
                    </div>
                    <div class="step active"> <div class="step-icon"><i class="fas fa-hammer"></i></div>
                        <span>Geliştirme</span>
                        <div class="pulse-ring"></div>
                    </div>
                    <div class="step">
                        <div class="step-icon"><i class="fas fa-bug"></i></div>
                        <span>Test & Fix</span>
                    </div>
                    <div class="step">
                        <div class="step-icon"><i class="fas fa-check-circle"></i></div>
                        <span>Teslimat</span>
                    </div>
                </div>

                <div class="hud-details">
                    <div class="detail-box">
                        <span class="detail-label">Tahmini Bitiş</span>
                        <span class="detail-value" id="endDate">15 Mart 2025</span>
                    </div>
                    <div class="detail-box">
                        <span class="detail-label">Müşteri</span>
                        <span class="detail-value" id="clientName">Ahmet Y.</span>
                    </div>
                    <div class="detail-box">
                        <span class="detail-label">Son Güncelleme</span>
                        <span class="detail-value">2 saat önce: "Işıklandırma başladı."</span>
                    </div>
                </div>
            </div>

            <div id="errorMsg" class="error-box" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <span>Sipariş bulunamadı! Lütfen kodu kontrol edin.</span>
            </div>

        </div>
    </section>

    <footer class="footer">
        <div class="footer-content"><p>© 2025 Upsilon Dev Studio.</p></div>
    </footer>

<script>
        // Sayfa Yüklendiğinde URL Kontrolü
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            
            if(code) {
                document.getElementById('orderInput').value = code;
                startTracking(); // Otomatik Başlat
            }
        });

        function startTracking() {
            const input = document.getElementById('orderInput').value.trim();
            const loader = document.getElementById('loadingUI');
            const result = document.getElementById('resultHUD');
            const error = document.getElementById('errorMsg');
            const terminal = document.getElementById('terminalLog');

            result.style.display = 'none';
            error.style.display = 'none';
            
            if(input === "") { alert("Kod giriniz!"); return; }

            loader.style.display = 'block';
            
            // Hızlı Animasyon
            let i = 0;
            terminal.innerHTML = "> Bağlanıyor...<br>";
            let interval = setInterval(() => {
                i++;
                if(i > 2) { // Kısa sürsün
                    clearInterval(interval);
                    setTimeout(() => {
                        loader.style.display = 'none';
                        checkOrder(input); // Veriyi Kontrol Et
                    }, 500);
                }
            }, 300);
        }

        function checkOrder(id) {
            const storedOrders = localStorage.getItem("upsilonOrders");
            const orders = storedOrders ? JSON.parse(storedOrders) : [];
            const order = orders.find(o => o.id === id);

            if(order) {
                // VERİLERİ DOLDUR
                document.getElementById('projName').innerText = order.service;
                document.getElementById('mainStatus').innerText = order.status;
                document.getElementById('clientName').innerText = order.customer;
                
                // Adminin Girdiği Verileri Çek
                // Tarih Alanı
                document.getElementById('endDate').innerText = order.endDate || "Planlanıyor...";
                
                // Not Alanı (Son Güncelleme Kısmına Yazıyoruz)
                const noteBox = document.querySelector('.detail-box:last-child .detail-value');
                noteBox.innerText = order.adminNote || "Henüz bir not girilmedi.";

                // İlerleme Çubuğunu Güncelle (Step 1-5)
                const steps = document.querySelectorAll('.step');
                const currentStep = parseInt(order.progressStep) || 1;

                steps.forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    // Mevcut adım
                    if (index + 1 === currentStep) {
                        step.classList.add('active');
                        // Pulse halkası ekle
                        if(!step.querySelector('.pulse-ring')) {
                            step.innerHTML += '<div class="pulse-ring"></div>';
                        }
                    } 
                    // Geçmiş adımlar
                    else if (index + 1 < currentStep) {
                        step.classList.add('completed');
                        // Halkayı sil
                        const ring = step.querySelector('.pulse-ring');
                        if(ring) ring.remove();
                    } 
                    // Gelecek adımlar
                    else {
                        const ring = step.querySelector('.pulse-ring');
                        if(ring) ring.remove();
                    }
                });

                document.getElementById('resultHUD').style.display = 'block';
            } else {
                document.getElementById('errorMsg').style.display = 'flex';
            }
        }
    </script>
</body>
</html>